#URL改写教程（Android）



[TOC]

## 原理
通过热点来构建局域网环境，利用shadowrocket的局域网代理共享功能为其他局域网内的用户提供URL改写功能。由于Android平台暂无（可能是我没找到）具备功能类似于shadowrocket的软件，如果要实现类似的功能，可以尝试以下“奇技淫巧”。

## 准备
至少需要3台设备，各有职责
A:必须iOS，装有shadowrocket，负责提供代理和切换规则，自身也可以实现url改写功能。
B:iOS/Android，作为热点供他人连接，提供局域网环境，自身**无法**实现url改写功能。
C：iOS/Android，使用者，自身可以实现url改写功能。

### A设备的准备
按照iOS的教程完整设置，如果需要为多人提供URL改写服务，可如下图设置导入多个配置。换人使用时只需要切换配置文件。（HTTPS解密证书默认是一致，如不一致请分别配置）
![IMG_843](https://i.loli.net/2021/05/20/4bRYGHeqLWaxP3r.jpg)

前往“设置”->“代理”->“代理共享"，如下图所示，开启，图中信息后面将用到。
![IMG_844](https://i.loli.net/2021/05/20/E8HYXPZbGc65x9f.jpg)


### B设备的准备
开启热点，其他设备均连接到此热点。B设备无法实现URL改写功能。

### 使用者(C设备)的准备
使用者均按照以下方法配置。

**连接热点后**，系统设置->无线局域网设置(WiFi设置)
点开正在连接的热点的”网络详情“，翻到底下：
* 安卓，会有个代理的选项，默认为”无“，需要改为”手动“。（各品牌各机型字样不同）
* iOS，为HTTP代理，默认为”关闭“，需要改为”手动“。

填写A设备提供的”代理共享“的配置信息(见上文图)，本教程中为
`服务器(主机名)：172.20.10.4
端口：1082
（仅填写以上两项，其他的选项如果有都保持默认状态）`

保存设置(返回)。
## 使用
1、B设备打开热点，其余所有设备连接热点。
2、A设备完成上述准备工作。
3、使用者完成上述准备工作。
4、A设备打开VPN开关，选择正确的配置文件。
5、使用者进行测试，测试完后正常使用。

## 注意事项
1. 使用者在配置完代理后，需要A设备打开VPN开关**才能上网**，不打开的话什么网页都打不开。如果想恢复原状使用者必须将WiFi设置中的”代理“切换为”关闭“状态。
2. 所有使用者跳转的地址都由A设备控制，如果A设备不进行规则的切换，所有使用者都将跳转到相同的网页。


